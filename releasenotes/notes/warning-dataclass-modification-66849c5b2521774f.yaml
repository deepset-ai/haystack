---
enhancements:
  - |
    Haystack now emits a ``Warning`` when dataclass instances (e.g. ``Document``, ``ChatMessage``,
    ``StreamingChunk``, ``ByteStream``, ``SparseEmbedding``) are mutated in place.
    Modifying shared instances can cause unexpected behavior in other parts of the pipeline.
    Use ``dataclasses.replace`` to safely create updated copies instead.

    Instead of modifying attributes in place:

    .. code-block:: python

        from haystack.dataclasses import Document

        doc = Document(content="old text", meta={"key": "value"})

        # Not recommended: can affect other parts of the pipeline
        doc.content = "new text"

    Use ``dataclasses.replace`` to create a new instance with the updated values:

    .. code-block:: python

        from dataclasses import replace
        from haystack.dataclasses import Document

        doc = Document(content="old text", meta={"key": "value"})

        # Recommended: creates a new Document with updated content
        doc = replace(doc, content="new text")
